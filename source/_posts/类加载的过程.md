---
title: 类加载的过程
date: 2020-05-25 20:59:55
tags: JVM
categories: JVM
---

## 概述

> 本章介绍类加载的过程

<!--more-->

## 正文

![](https://photos.alitaalice.cn/image/20200525210206.png)

### 1 加载

JAVA虚拟机需要完成：

1 通过一个类的全限定名来获取定义此类的二进制字节流

2 通过这个字节流所代表的静态存储结构转化为方法区的运行时数据结构

3 在内存中生成一个代表这个类的java.lang.Class对象 作为方法区这个类的各种数据的访问入口。

### 2 验证

验证是连接阶段的第一步，这么做是确保Class文件的字节流中包含的信息符合《JAVA虚拟机规范》的全部约束要求，保证这些信息被当作代码运行后不会危害虚拟机自身的安全

分为：

1 文件格式验证

2 元数据验证

3 字节码验证

4 符号引用验证

### 3 准备

准备阶段是正式为类中定义的变量（静态变量、被static修饰的变量）分配内存并设置类变量初始值的阶段，从概念上讲，这些变量所使用的内存都应当在方法区中进行分配

### 4 解析

解析阶段是JAVA虚拟机将常量池内的符号引用替换为直接引用的过程。

符号引用：符号引用以一组符号来描述所引用的目标，符号可以是任何形式的字面量

直接引用：直接引用是可以直接指向目标的指针

### 5 初始化

直到初始化阶段，JAVA虚拟机才真正开始执行类中编写的JAVA程序代码，将主导权移交给应用程序。

初始化阶段就是执行类构造器<clinit>()方法的过程。<clinit>()并不是程序员在JAVA代码中直接编写的方法，它是JAVAC编译器的自动生成物，

